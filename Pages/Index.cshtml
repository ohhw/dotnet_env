@page
@model App.Pages.IndexModel
@{
    ViewData["Title"] = "í™ˆ";
}

<!-- ë©”ì¸ ì»¨í…ì¸ ë¥¼ ì¢Œìš°ë¡œ ë¶„í•  -->
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; max-width: 100%; margin: 0; padding: 10px;">
    
    <!-- ì¢Œì¸¡ ì˜ì—­: ê¸°ì¡´ ì»¨í…ì¸  -->
    <div style="background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
        
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 15px; margin-bottom: 30px; text-align: center; box-shadow: 0 8px 32px rgba(0,0,0,0.1);">
            <h1 style="margin-bottom: 20px; font-size: 2.2em;">Hello, @(Model.UserName)ë‹˜!</h1>
            
            @if (Model.UserName == "ë°©ë¬¸ì")
            {
                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin-top: 20px;">
                    <p style="margin-bottom: 15px; font-size: 1.1em;">ğŸ‘‹ ì•ˆë…•í•˜ì„¸ìš”! ì´ë¦„ì„ ì•Œë ¤ì£¼ì‹œë©´ ë” ì¹œê·¼í•˜ê²Œ ì¸ì‚¬ë“œë¦´ê²Œìš”!</p>
                    <form method="post" style="display: flex; gap: 10px; justify-content: center; align-items: center; flex-wrap: wrap;">
                        @Html.AntiForgeryToken()
                        <input type="text" name="userName" placeholder="ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" required 
                               style="padding: 12px 16px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px; min-width: 200px; color: #333;">
                        <button type="submit" style="background: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px;">
                            âœ¨ ì¸ì‚¬í•˜ê¸°
                        </button>
                    </form>
                </div>
            }
            else
            {
                <p style="font-size: 1.1em; opacity: 0.9;">í™˜ì˜í•©ë‹ˆë‹¤! ì˜¤ëŠ˜ë„ ì¢‹ì€ í•˜ë£¨ ë˜ì„¸ìš”! ğŸŒŸ</p>
                <div style="margin-top: 15px;">
                    <a href="/" style="background: #007bff; color: white; padding: 12px 20px; text-decoration: none; border-radius: 5px; font-size: 14px;">
                        ğŸ  í™ˆìœ¼ë¡œ
                    </a>
                </div>
            }
        </div>

        <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; margin: 20px 0; text-align: center;">
            <h3 style="margin: 0 0 15px 0; color: #1976d2;">â° í˜„ì¬ ì‹œê°„</h3>
            <div style="font-size: 18px; font-weight: bold; color: #333; margin-bottom: 8px;">
                @DateTime.Now.ToString("yyyyë…„ MMì›” ddì¼")
            </div>
            <div style="font-size: 24px; font-weight: bold; color: #1976d2;">
                @DateTime.Now.ToString("HH:mm:ss")
            </div>
        </div>

        <div style="text-align: center; margin: 10px 0;">
            <button onclick="location.reload()" style="background: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; margin: 0 5px;">ğŸ”„ ì‹œê°„ ìƒˆë¡œê³ ì¹¨</button>
            <button onclick="window.location.href='/Time'" style="background: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; margin: 0 5px;">ğŸ• ì‹œê°„ í˜ì´ì§€</button>
            <button onclick="window.location.href='/Time?format=json'" style="background: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; margin: 0 5px;">ğŸ“Š JSON í˜•ì‹</button>
        </div>

        <div style="background: #e9ecef; padding: 15px; border-radius: 10px; margin: 20px 0;">
            <h3 style="margin: 0 0 15px 0; color: #495057;">ğŸ“ ë©”ëª¨ì¥</h3>
            
            <form method="post" style="margin-bottom: 15px;">
                @Html.AntiForgeryToken()
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" name="newMemo" placeholder="ìƒˆ ë©”ëª¨ ì¶”ê°€..." required style="flex: 1; padding: 12px 16px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px;">
                    <button type="submit" name="action" value="add" style="background: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; white-space: nowrap;">
                        â• ì¶”ê°€
                    </button>
                </div>
            </form>
            
            <div style="text-align: center; margin-top: 15px;">
                <button onclick="window.location.href='/Memo'" style="background: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px;">ğŸ“‹ ë©”ëª¨ í˜ì´ì§€</button>
            </div>
        </div>

        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin: 20px 0; border: 2px solid #dee2e6;">
            <h3 style="margin: 0 0 15px 0; color: #495057; text-align: center;">ğŸ§® ê°„ë‹¨ ê³„ì‚°ê¸°</h3>
            
            <div style="max-width: 400px; margin: 0 auto;">
                <input type="text" id="homeCalculatorInput" 
                       placeholder="ê³„ì‚°ì‹ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: 2+3*4, sin(30), sqrt(16))" 
                       style="width: 100%; padding: 12px 16px; border: 1px solid #ddd; border-radius: 5px; margin-bottom: 10px; font-size: 14px; font-family: 'Courier New', monospace; text-align: center;">
                
                <div style="text-align: center; margin-bottom: 15px;">
                    <button onclick="calculateHomeExpression()" 
                            style="background: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; margin-right: 10px;">
                        ê³„ì‚°í•˜ê¸°
                    </button>
                    <button onclick="clearHomeCalculator()" 
                            style="background: #dc3545; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px;">
                        ì§€ìš°ê¸°
                    </button>
                </div>
                
                <div id="homeCalculatorResult" style="background: #f8f9fa; color: #333; padding: 12px 16px; border-radius: 5px; text-align: center; font-family: -apple-system, BlinkMacSystemFont, sans-serif; font-size: 14px; min-height: 25px; border: 1px solid #ddd; margin-bottom: 15px;">ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</div>
                
                <div style="text-align: center;">
                    <button onclick="window.location.href='/Calculator'" style="background: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px;">ğŸ§® ê³ ê¸‰ ê³„ì‚°ê¸°</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ìš°ì¸¡ ì˜ì—­: ì§€ë„ ê´€ë ¨ ê¸°ëŠ¥ (ê°„ì†Œí™”) -->
    <div style="background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
        
        <!-- ì‹¤ì‹œê°„ ì§€ë„ (Googleë§Œ) -->
        <div style="background: #f8f9fa; padding: 15px; border-radius: 12px; border: 1px solid #e9ecef; margin-bottom: 20px;">
            <h3 style="color: #333; margin-bottom: 15px; text-align: center;">ğŸ—ºï¸ ì‹¤ì‹œê°„ ì§€ë„ (Google)</h3>
            <p id="mapDescription" style="text-align: center; color: #666; margin-bottom: 15px; font-size: 14px;">Google ì§€ë„ (ì‹¤ì‹œê°„)</p>
            <iframe id="mapFrame" 
                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d25320.27!2d126.9780!3d37.5665!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x357ca2eb6b5ace79%3A0x5e0d96d2b6b08b12!2z7ISc7Jq4!5e0!3m2!1sko!2skr!4v1691234567890!5m2!1sko!2skr" 
                    width="100%" 
                    height="300" 
                    style="border: none; border-radius: 8px;"
                    allowfullscreen="" 
                    loading="lazy" 
                    referrerpolicy="no-referrer-when-downgrade">
            </iframe>
            <div style="text-align: center; margin-top: 10px;">
                <button onclick="switchToGoogle()" style="background: #4285f4; color: white; padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; font-size: 12px;">ğŸ”„ ì§€ë„ ìƒˆë¡œê³ ì¹¨</button>
            </div>
        </div>

        <!-- ê²½ë¡œ ê²€ìƒ‰ (Googleë§Œ) -->
        <div style="background: #f8f9fa; padding: 20px; border-radius: 12px; border: 1px solid #e9ecef; margin-bottom: 20px;">
            <h4 style="color: #333; margin-bottom: 15px; text-align: center;">ğŸ“ ê²½ë¡œ ê²€ìƒ‰ (Google)</h4>
            <div style="margin-bottom: 12px;">
                <input type="text" id="startLocation" placeholder="ğŸ“ ì¶œë°œì§€ ì…ë ¥" 
                       style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 10px; font-size: 14px;" />
            </div>
            <div style="margin-bottom: 15px;">
                <input type="text" id="endLocation" placeholder="ğŸ¯ ë„ì°©ì§€ ì…ë ¥" 
                       style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; margin-bottom: 15px; font-size: 14px;" />
            </div>
            <div style="display: grid; grid-template-columns: 1fr; gap: 10px;">
                <button onclick="routeSearch()" style="background: linear-gradient(135deg, #007bff 0%, #0056b3 100%); color: white; padding: 12px 16px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: bold; box-shadow: 0 2px 8px rgba(0,123,255,0.3); transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    ğŸš— Google ì§€ë„ë¡œ ê¸¸ì°¾ê¸°
                </button>
            </div>
        </div>

        <!-- ë¹ ë¥¸ ì¥ì†Œ ê²€ìƒ‰ (3ê°œ ì„œë¹„ìŠ¤) -->
        <div style="background: #f8f9fa; padding: 20px; border-radius: 12px; border: 1px solid #e9ecef;">
            <h4 style="color: #333; margin-bottom: 15px; text-align: center;">ğŸ” ë¹ ë¥¸ ì¥ì†Œ ê²€ìƒ‰</h4>
            <div style="margin-bottom: 15px;">
                <input type="text" id="quickSearchLocation" placeholder="ì¥ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”" 
                       style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; box-sizing: border-box;">
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px;">
                <button onclick="quickSearchGoogle()" style="background: #4285f4; color: white; padding: 10px; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: bold; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    ğŸŒ Google
                </button>
                <button onclick="quickSearchNaver()" style="background: #03c75a; color: white; padding: 10px; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: bold; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    ğŸŸ¢ ë„¤ì´ë²„
                </button>
                <button onclick="quickSearchKakao()" style="background: #fee500; color: #3c1e1e; padding: 10px; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: bold; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                    ğŸŸ¡ ì¹´ì¹´ì˜¤
                </button>
            </div>
        </div>
        
        <!-- ì§€ë„ í˜ì´ì§€ ì´ë™ ë²„íŠ¼ -->
        <div style="text-align: center; margin-top: 15px;">
            <button onclick="window.location.href='/Map'" style="background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px;">ğŸ—ºï¸ ì§€ë„ í˜ì´ì§€</button>
        </div>
    </div>
</div>

<!-- ì™¸ë¶€ JavaScript íŒŒì¼ ë¡œë“œ -->
<script src="~/js/maps.js"></script>
<script src="~/js/calculator.js"></script>

<script>
    // ì—”í„°í‚¤ ì´ë²¤íŠ¸ ë° ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', function() {
        // ë¹ ë¥¸ ê²€ìƒ‰ ì—”í„°í‚¤ ì´ë²¤íŠ¸
        const quickSearchInput = document.getElementById('quickSearchLocation');
        if (quickSearchInput) {
            quickSearchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    quickSearchGoogle(); // ê¸°ë³¸ê°’ìœ¼ë¡œ Google ê²€ìƒ‰
                }
            });
        }
        
        // ê²½ë¡œ ê²€ìƒ‰ ì—”í„°í‚¤ ì´ë²¤íŠ¸
        const startInput = document.getElementById('startLocation');
        const endInput = document.getElementById('endLocation');
        
        if (startInput) {
            startInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    if (endInput) endInput.focus();
                }
            });
        }
        
        if (endInput) {
            endInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    routeSearch(); // í†µí•© ê²½ë¡œ ê²€ìƒ‰ í•¨ìˆ˜ ì‚¬ìš©
                }
            });
        }
    });

    // í™ˆ í™”ë©´ ê°„ë‹¨ ê³„ì‚°ê¸° í•¨ìˆ˜ë“¤
    function calculateHomeExpression() {
        const input = document.getElementById('homeCalculatorInput');
        const result = document.getElementById('homeCalculatorResult');
        
        if (!input.value.trim()) {
            result.textContent = 'ê³„ì‚°ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”';
            result.style.color = '#ffc107';
            return;
        }
        
        try {
            let expression = input.value.trim();
            
            // ê¸°ë³¸ ìˆ˜í•™ í•¨ìˆ˜ë“¤ ì²˜ë¦¬
            expression = expression.replace(/sin\(/g, 'Math.sin(Math.PI/180*');
            expression = expression.replace(/cos\(/g, 'Math.cos(Math.PI/180*');
            expression = expression.replace(/tan\(/g, 'Math.tan(Math.PI/180*');
            expression = expression.replace(/sqrt\(/g, 'Math.sqrt(');
            expression = expression.replace(/log\(/g, 'Math.log10(');
            expression = expression.replace(/ln\(/g, 'Math.log(');
            expression = expression.replace(/abs\(/g, 'Math.abs(');
            expression = expression.replace(/pow\(/g, 'Math.pow(');
            expression = expression.replace(/\^/g, '**');
            
            // ì•ˆì „í•œ ê³„ì‚°ì„ ìœ„í•´ Function ì‚¬ìš©
            const calculationResult = Function(`"use strict"; return (${expression})`)();
            
            result.textContent = `= ${calculationResult}`;
            result.style.color = '#0f0';
        } catch (error) {
            result.textContent = 'ê³„ì‚° ì˜¤ë¥˜: ì˜¬ë°”ë¥¸ ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”';
            result.style.color = '#dc3545';
        }
    }
    
    function clearHomeCalculator() {
        document.getElementById('homeCalculatorInput').value = '';
        document.getElementById('homeCalculatorResult').textContent = 'ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤';
        document.getElementById('homeCalculatorResult').style.color = '#0f0';
    }
    
    // Enter í‚¤ë¡œ ê³„ì‚° ì‹¤í–‰
    document.addEventListener('DOMContentLoaded', function() {
        const input = document.getElementById('homeCalculatorInput');
        if (input) {
            input.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    calculateHomeExpression();
                }
            });
        }
    });
</script>
